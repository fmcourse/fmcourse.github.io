---
title: "Упражнения по теме Язык Event-B"
---


1. В системе есть _процессы_, которые пытаются войти в
   _критическую секцию_. В каждый момент времени в ней
   может находиться не более 1 процесса. Опишите модель со
   следующими событиями и докажите ее корректность в Rodin.

   - `request(p)` --- запрос на вход в критическую секцию от
     процесса `p`

   - `enter(p)` --- вход процесса `p` в критическую секцию

   - `leave(p)` --- выход процесса `p` из критической секции


1. В системе есть _производители_ и _потребители_, которые
   используют общий буфер размера не более _MAX_. Буфер
   не может переполняться. Опишите
   модель со следующими событиями и докажите ее корректность
   (структура буфера не моделируется):

   - `produce(n)` --- добавление `n` в буфер

   - `consume(n)` --- извлечение `n` из буфера


1. В системе есть _производители_ и _потребители_, которые
   используют общий буфер размера не более _MAX_. Буфер
   не может переполняться. Процесс не может одновременно
   выполнять операцию производства и операцию потребления. Опишите
   модель со следующими событиями и докажите ее корректность
   (структура буфера не моделируется):

   - `produce_request(p, n)` --- запрос на добавление `n` в буфер
     от процесса `p`

   - `produce_complete(p)` --- выполнение запроса на добавление
     от процесса `p`

   - `consume_request(p, n)` --- запрос на извлечение `n` из буфера
     от процесса `p`

   - `consume_complete(p)` --- выполнение запроса на извлечение
     от потребителя `p`

1. На железнодорожном переезде установлен _шлагбаум_. Шлагбаум
   может быть в одном из следующих состояний: `open`, `closed`.
   _Поезд_ может быть в одном из следующих состояний: `far`,
   `near`, `on`, `gone`. Шлагбаум должен быть
   закрыт, когда по переезду передвигается поезд (`on`). Опишите модель
   со следующими событиями и докажите ее корректность:

   - `train_approaches` --- поезд подходит к переезду
   - `train_enters` --- поезд начинает движение по переезду
   - `train_leaves` --- поезд завершил движение по переезду
   - `close_gate` --- закрыть шлагбаум
   - `open_gate` --- открыть шлагбаум


1. В банке есть несколько _счетов_, каждому счету сопоставлена
   некоторая натуральная сумма (<code>balance &#x2208; ACCOUNTS +-> NAT</code>).
   Между счетами можно совершать переводы. При этом суммарный
   баланс всех счетов должен сохраниться. Опишите модель
   с единственным событием и докажите ее корректность:
   `transfer(from, to, amount)` --- перевод `amount` со счета
   `from` на счет `to`.

   _Примечание_: в Event-B нет встроенной суммы, для ее определения
   можно использовать такой набор аксиом: сумма от пустого
   множества, сумма от множества из 1 элемента, сумма объединения
   непересекающихся множеств.

## Упражнения для выполнения на компьютере

1. Кофе-автомат готовит кружку вкусного напитка в обмен на монету.
   Он состоит из механизма для приготовления кофе, бака для воды,
   отсека для кофейных зерен, блока из стаканчиков и отсека для
   монет, различных шлангов и блока программного управления.
   На передней панели кофе-автомата расположены щель для монеты, экран с живой
   рекламой и отсек, куда попадает стаканчик с готовым напитком.

   На одну кружку кофе уходит `N` единиц воды, `M` единиц кофейных
   зерен и 1 стаканчик. Бак для воды вмещает до `W` единиц воды.
   Отсек для кофейных зерен вмещает до `C` единиц кофейных зерен.

   Щель для монеты может быть открыта или закрыта. Если не хватает
   ингредиентов или стаканчиков или автомат в данный момент варит
   кофе, щель должна быть закрыта. В остальных случаях она
   должна быть открыта.

   Сзади автомата есть замочная скважина для обслуживающего персонала.
   Используя соответствующий ключ, задняя стенка открывается
   и возможно добавить ингредиенты и забрать монеты.

   Напишите формальную модель кофе-автомата на следующем уровне
   абстракции: моделируется щель, ингредиенты, готовит ли механизм
   кофе. Найдите требования, которые нужно выразить при помощи
   инвариантов. При помощи `Rodin` верифицируйте модель.


1. Дана блок-схема с одной входной переменной, двумя промежуточными
   переменным и одной выходной переменной. Домены всех переменных
   множество всех целых чисел.
   Целочисленное деление <code>a / b</code> определено только для
   тех пар целых чисел <code>(a, b)</code>, в которых <code>a</code>
   неотрицательно, а <code>b</code> положительно.

   Обозначим <code>isqrt(x)</code>
   целочисленный квадратный корень целого неотрицательного <code>x</code>.
   Докажите полную корректность блок-схемы относительно спецификации

   <code>&straightphi;(x) &equiv; x &ge; 0</code>

   <code>&psi;(x, z) &equiv; z = isqrt(x)</code>

   ![блок-схема к заданию 3.2](b3_2.png)

   Оформите доказательство в виде контекста `Event-B` следующего вида.
   Определите <code>isqrt</code> как константу типа функция. В виде
   аксиомы, не являющейся теоремой, запишите определение <code>isqrt</code>:
   для всех целых неотрицательных <code>x</code> справедливо неравенство

   <code>isqrt(x) * isqrt(x) &le; x &lt; (isqrt(x) + 1) * (isqrt(x) + 1)</code>.

   Оформите каждое условие верификации как аксиому-теорему.

   Для повышения читабельности можно оформить индуктивное утверждение,
   оценочную функцию и т.п. как еще одни константы аналогично <code>isqrt</code>
   и можно добавлять дополнительные аксиомы-теоремы.

   Докажите все аксиомы-теоремы средствами `Rodin`.
